!function(e){var t={};function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./",i(i.s=9)}([function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}},function(e,t,i){var r=i(10),a=i(0);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(t)}e.exports=i},function(e,t,i){var r=i(11);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,i){e.exports=i(12)},function(e,t){function i(e,t,i,r,a,s,n){try{var o=e[s](n),c=o.value}catch(e){return void i(e)}o.done?t(c):Promise.resolve(c).then(r,a)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(a,s){var n=e.apply(t,r);function o(e){i(n,a,s,o,c,"next",e)}function c(e){i(n,a,s,o,c,"throw",e)}o(void 0)})}}},function(e,t,i){var r=i(14);e.exports=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),a.forEach(function(t){r(e,t,i[t])})}return e}},function(e,t,i){e.exports=i(15)},function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?e.exports=r=function(e){return i(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},r(t)}e.exports=r},function(e,t){function i(t,r){return e.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(t,r)}e.exports=i},function(e,t,i){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),a=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,s=a&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=i(13),a)r.regeneratorRuntime=s;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var i,r=Object.prototype,a=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},n=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag",h="object"==typeof e,l=t.regeneratorRuntime;if(l)h&&(e.exports=l);else{(l=t.regeneratorRuntime=h?e.exports:{}).wrap=k;var m="suspendedStart",u="suspendedYield",d="executing",p="completed",f={},y={};y[n]=function(){return this};var g=Object.getPrototypeOf,b=g&&g(g(M([])));b&&b!==r&&a.call(b,n)&&(y=b);var v=S.prototype=x.prototype=Object.create(y);_.prototype=v.constructor=S,S.constructor=_,S[c]=_.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(v),e},l.awrap=function(e){return{__await:e}},P(F.prototype),F.prototype[o]=function(){return this},l.AsyncIterator=F,l.async=function(e,t,i,r){var a=new F(k(e,t,i,r));return l.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},P(v),v[c]="Generator",v[n]=function(){return this},v.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},l.values=M,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(G),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=i)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return o.type="throw",o.arg=e,t.next=r,a&&(t.method="next",t.arg=i),!!a}for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s],o=n.completion;if("root"===n.tryLoc)return r("end");if(n.tryLoc<=this.prev){var c=a.call(n,"catchLoc"),h=a.call(n,"finallyLoc");if(c&&h){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(c){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return r(n.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var n=s?s.completion:{};return n.type=e,n.arg=t,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),G(i),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var a=r.arg;G(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:M(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=i),f}}}function k(e,t,i,r){var a=t&&t.prototype instanceof x?t:x,s=Object.create(a.prototype),n=new j(r||[]);return s._invoke=function(e,t,i){var r=m;return function(a,s){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===a)throw s;return C()}for(i.method=a,i.arg=s;;){var n=i.delegate;if(n){var o=L(n,i);if(o){if(o===f)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===m)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=d;var c=w(e,t,i);if("normal"===c.type){if(r=i.done?p:u,c.arg===f)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=p,i.method="throw",i.arg=c.arg)}}}(e,i,n),s}function w(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}function x(){}function _(){}function S(){}function P(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function F(e){var t;this._invoke=function(i,r){function s(){return new Promise(function(t,s){!function t(i,r,s,n){var o=w(e[i],e,r);if("throw"!==o.type){var c=o.arg,h=c.value;return h&&"object"==typeof h&&a.call(h,"__await")?Promise.resolve(h.__await).then(function(e){t("next",e,s,n)},function(e){t("throw",e,s,n)}):Promise.resolve(h).then(function(e){c.value=e,s(c)},function(e){return t("throw",e,s,n)})}n(o.arg)}(i,r,t,s)})}return t=t?t.then(s,s):s()}}function L(e,t){var r=e.iterator[t.method];if(r===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=i,L(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var a=w(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var s=a.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=i),t.delegate=null,f):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function G(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function M(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=i,t.done=!0,t};return s.next=s}}return{next:C}}function C(){return{value:i,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},function(e,t,i){"use strict";i.r(t);var r=i(1),a=i.n(r),s=i(2),n=i.n(s),o=i(3),c=i.n(o),h=i(4),l=i.n(h),m=i(5),u=i.n(m),d=(Phaser.Scene,Phaser.Scene,i(6)),p=i.n(d),f=i(7),y=i.n(f);function g(e){var t={key:"brickTile",frames:e.anims.generateFrameNumbers("tiles",{start:14,end:14,first:14})};e.anims.create(t),t={key:"blockTile",frames:e.anims.generateFrameNumbers("tiles",{start:43,end:43,first:43})},e.anims.create(t),["","Super","Fire"].forEach(function(i){t={key:"run"+i,frames:e.anims.generateFrameNames("mario-sprites",{prefix:"mario/walk"+i,start:1,end:3}),frameRate:10,repeat:-1,repeatDelay:0},e.anims.create(t),["jump","stand","turn","bend"].forEach(function(r){"bend"===r&&""===i||(t.key=r+i,t.frames=[{frame:"mario/"+r+i,key:"mario-sprites"}],e.anims.create(t))}),t.key="climb"+i,t.frames=e.anims.generateFrameNames("mario-sprites",{prefix:"mario/climb"+i,start:1,end:2}),e.anims.create(t),t.key="swim"+i,t.frames=e.anims.generateFrameNames("mario-sprites",{prefix:"mario/swim"+i,start:1,end:6}),e.anims.create(t)}),t.key="death",t.frames=e.anims.generateFrameNumbers("mario",{start:22,end:22}),e.anims.create(t);var i=[];["mario/half","mario/stand","mario/half","mario/standSuper","mario/half","mario/standSuper"].forEach(function(e){i.push({frame:e,key:"mario-sprites"})}),t={key:"grow",frames:i,frameRate:10,repeat:0,repeatDelay:0},e.anims.create(t),t={key:"shrink",frames:i.reverse(),frameRate:10,repeat:0,repeatDelay:0},e.anims.create(t),t={key:"goomba",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"goomba/walk",start:1,end:2}),frameRate:5,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"goombaFlat",frames:[{key:"mario-sprites",frame:"goomba/flat"}]},e.anims.create(t),t={key:"turtle",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"turtle/turtle",end:1}),frameRate:5,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"mario/climb",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"mario/climb",end:1}),frameRate:5,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"mario/climbSuper",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"mario/climbSuper",end:1}),frameRate:5,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"flag",frames:[{key:"mario-sprites",frame:"flag"}],repeat:-1},e.anims.create(t),t={key:"turtleShell",frames:[{frame:"turtle/shell",key:"mario-sprites"}]},e.anims.create(t),t={key:"mushroom",frames:[{frame:"powerup/super",key:"mario-sprites"}]},e.anims.create(t),t={key:"coin",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"coin/spin",start:1,end:4}),frameRate:30,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"1up",frames:[{frame:"powerup/1up",key:"mario-sprites"}]},e.anims.create(t),t={key:"flower",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"powerup/flower",start:1,end:4}),frameRate:30,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"star",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"powerup/star",start:1,end:4}),frameRate:30,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"dpad",frames:[{frame:"controller/dpad",key:"mario-sprites"}]},e.anims.create(t),t={key:"button",frames:[{frame:"controller/button",key:"mario-sprites"}]},e.anims.create(t),t={key:"fireFly",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"fire/fly",start:1,end:4}),frameRate:10,repeat:-1,repeatDelay:0},e.anims.create(t),t={key:"fireExplode",frames:e.anims.generateFrameNames("mario-sprites",{prefix:"fire/explode",start:1,end:3}),frameRate:30,repeat:0,repeatDelay:0},e.anims.create(t)}var b=function(e){function t(){return a()(this,t),c()(this,l()(t).call(this,{key:"PreLoadScene"}))}var i;return u()(t,e),n()(t,[{key:"preload",value:function(){var e=this.cameras.main,t=e.width,i=e.height;this.assetText=this.make.text({x:t/2,y:i/2-75,text:"Loading...",style:{font:"20px monospace",fill:"#ffffff"}}).setOrigin(.5,.5),this.load.on("progress",this.onProgress,this),this.load.on("fileprogress",this.onFileProgress,this),this.load.multiatlas("atlas_object","resource/atalas/atlas_object.json","resource/atalas"),this.load.multiatlas("mario-sprites","resource/atalas/mario-sprites.json","resource/atalas"),this.load.bitmapFont("font","resource/fonts/font.png","resource/fonts/font.fnt"),this.load.tilemapTiledJSON({key:"level1",url:"resource/tilemap/level1.json"}),this.load.spritesheet("brick","resource/img/Levels/brick.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("blockCollisioned","resource/img/Levels/blockCollisioned.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("brick2","resource/img/Levels/brick2.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("randomBox","resource/img/Levels/questionMarkBlock.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("randomBox2","resource/img/Levels/questionMarkBlock_2.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("brickCoins","resource/img/Levels/brickCoins.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("brickCoins2","resource/img/Levels/brickCoins_2.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("coinBlock","resource/img/Items/coinBlock.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("mushroom","resource/img/Items/mushroom.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("flower","resource/img/Items/flower.png",{frameWidth:16,frameHeight:16}),this.load.image("tileset_levels","resource/tilemap/tileset_levels.png"),this.load.image("red","resource/particles/red.png"),this.load.spritesheet("small_mario","resource/tilemap/small_mario.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("big_mario","resource/tilemap/big_mario.png",{frameWidth:16,frameHeight:32}),this.load.spritesheet("goomba_red","resource/img/Enemies/Goomba/goomba_red.png",{frameWidth:16,frameHeight:16}),this.load.image("initTexture","resource/img/Items/coin.png"),this.load.spritesheet("koopa_green","resource/img/Enemies/Koopa/koopa_green.png",{frameWidth:16,frameHeight:24}),this.load.spritesheet("koopa_green_squish","resource/img/Enemies/Koopa/koopa_green_squish.png",{frameWidth:16,frameHeight:16}),this.load.pack("Preload","resource/pack.json","Preload")}},{key:"sleep",value:function(e){return new Promise(function(t){setTimeout(t,e)})}},{key:"create",value:(i=y()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("预加载完成"),this.buildAnimations(),g(this),this.scene.start("GameScene");case 4:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"buildAnimations",value:function(){this.anims.create({key:"left_anim",frames:this.anims.generateFrameNames("atlas_object",{start:9,end:11,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:8,repeat:-1}),this.anims.create({key:"right_anim",frames:this.anims.generateFrameNames("atlas_object",{start:3,end:5,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:8,repeat:-1}),this.anims.create({key:"faceRight_anim",frames:this.anims.generateFrameNames("atlas_object",{start:2,end:2,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:1,repeat:-1}),this.anims.create({key:"faceLeft_anim",frames:this.anims.generateFrameNames("atlas_object",{start:12,end:12,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:1,repeat:1}),this.anims.create({key:"jumpRight_anim",frames:this.anims.generateFrameNames("atlas_object",{start:6,end:6,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:1,repeat:1}),this.anims.create({key:"jumpLeft_anim",frames:this.anims.generateFrameNames("atlas_object",{start:8,end:8,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:1,repeat:1}),this.anims.create({key:"die_anim",frames:this.anims.generateFrameNames("atlas_object",{start:7,end:7,zeroPad:2,prefix:"Player/Mario_Small/small_mario_"}),frameRate:1,repeat:1})}},{key:"onProgress",value:function(e){if(this.preloadSprite){var t=Math.floor(this.preloadSprite.width*e);this.preloadSprite.sprite.frame.width=t,this.preloadSprite.sprite.frame.cutWidth=t,this.preloadSprite.sprite.frame.updateUVs()}}},{key:"onFileProgress",value:function(e){this.assetText.setText("正在加载: "+e.src)}}]),t}(Phaser.Scene),v=i(0),k=i.n(v),w=function(e){function t(e){var i;return a()(this,t),i=c()(this,l()(t).call(this,e.scene,e.x,e.y,"atlas_object","Player/Mario_Fire/fireBall_01")),e.scene.physics.world.enable(k()(k()(i))),i.scene=e.scene,i.damage=1,i.hasCollided=!1,i.body.setSize(8,8),i.body.setOffset(0,0),i.scene.add.existing(k()(k()(i))),i}return u()(t,e),n()(t,[{key:"fire",value:function(e,t,i){this.body.allowGravity=!0,this.setPosition(e,t),this.body.velocity.x=200*(i?-1:1),this.play("fireFly")}},{key:"update",value:function(){}},{key:"collided",value:function(){0===this.body.velocity.y&&(this.body.velocity.y=-150),0===this.body.velocity.x&&this.explode()}},{key:"explode",value:function(){this.body.allowGravity=!1,this.body.velocity.y=0,this.hasCollided||(this.play("fireExplode"),this.hasCollided=!0,this.once("animationcomplete",function(){this.scene.playerAttackGroup.remove(this,!0,!0)},this))}}]),t}(Phaser.GameObjects.Sprite),x=function(e){function t(e){var i;return a()(this,t),i=c()(this,l()(t).call(this,e.scene,e.x,e.y,"initTexture")),e.scene.physics.world.enable(k()(k()(i))),i.scene=e.scene,i.number=e.number,i.scene.add.existing(k()(k()(i))),i.scene.physics.world.enable(k()(k()(i))),i.alive=!0,i.body.allowGravity=!1,i.anims.play("coinBlock_anim"),i}return u()(t,e),n()(t,[{key:"update",value:function(){}},{key:"collidingBricksCoin",value:function(){var e=this;this.scene.tweens.add({targets:[this],y:this.y-2*this.height,duration:200,callbackScope:this,ease:"Quintic",yoyo:!0,onComplete:function(){e.scene.score+=50,e.destroy()}})}},{key:"collidingWithPlayer",value:function(){this.scene.score+=50,this.destroy()}}]),t}(Phaser.Physics.Arcade.Sprite),_=function(e){function t(e){var i;return a()(this,t),i=c()(this,l()(t).call(this,e.scene,e.x,e.y,"initTexture")),e.scene.physics.world.enable(k()(k()(i))),i.scene=e.scene,i.scene.add.existing(k()(k()(i))),i.scene.physics.world.enable(k()(k()(i))),i.alive=!0,i.direction=1,i.speed=60,i.life=1,i.scene.physics.add.collider(k()(k()(i)),i.scene.graphicLayer,function(){}),i.anims.play("mushroom_anim"),i}return u()(t,e),n()(t,[{key:"update",value:function(){this.body.onWall()&&(this.direction*=-1),this.body.velocity.x=this.direction*this.speed}},{key:"collidingBricks",value:function(){this.scene.tweens.add({targets:[this],y:this.y-2*this.height,duration:200,callbackScope:this,ease:"Quintic",yoyo:!0,onComplete:function(){}}),this.scene.player.x-this.x>=this.body.halfWidth?this.direction=-1:this.direction=1}},{key:"collidingWithPlayer",value:function(e,t){e.changeMode("upgrade"),this.destroy()}}]),t}(Phaser.Physics.Arcade.Sprite),S=function(e){function t(e){var i;return a()(this,t),(i=c()(this,l()(t).call(this,e))).anims.play("flower_anim"),i.body.allowGravity=!1,i}return u()(t,e),n()(t,[{key:"update",value:function(){}},{key:"collidingBricks",value:function(){this.scene.tweens.add({targets:[this],y:this.y-2*this.height,duration:200,callbackScope:this,ease:"Quintic",yoyo:!0,onComplete:function(){}})}}]),t}(_),P=function(e){function t(e,i){var r;a()(this,t),(r=c()(this,l()(t).call(this,e.scene,e.x,e.y,"initTexture"))).scene=e.scene,r.scene.add.existing(k()(k()(r))),r.scene.physics.world.enable(k()(k()(r))),r.setCollideWorldBounds(!0),r.bigMode=!1,r.fireMode=!1,r.direction=1,r.speed=150,r.jumpSpeed=210,r.life=i.life||3,r.alive=!0,r.isJumping=!1,r.ability={fireball:!1,invincible:!1,immune:!1},r.timeManage={nowTime:0,startInvincible:0,overInvincible:0},r.currentModeIndex=1,r.dieAnimPlaying=!1;var s=r.scene.add.particles("red");return r.emitter=s.createEmitter({radial:!1,lifespan:1e3,quantity:4,scale:{start:.6,end:0,ease:"Power3"},blendMode:"ADD"}),r.creatAnims(),r.creatControls(),r.eventEmitter=new Phaser.Events.EventEmitter,r.eventEmitter.on("getDamage",r.getDamageHandler,k()(k()(r))),r}return u()(t,e),n()(t,[{key:"update",value:function(e,t){if(this.timeManage.nowTime=e,this.alive)if(this.isJumping=this.body.blocked.none&&0!==this.body.velocity,this.keys.down.isDown)this.bigMode&&this.anims.play("bigSquat_anim");else if(this.keys.left.isDown){if(this.direction=-1,this.body.velocity.x=this.direction*this.speed,this.isJumping)return;this.bigMode?this.anims.play("bigLeft_anim",!0):this.anims.play("left_anim",!0)}else if(this.keys.right.isDown){if(this.direction=1,this.body.velocity.x=this.direction*this.speed,this.isJumping)return;this.bigMode?this.anims.play("bigRight_anim",!0):this.anims.play("right_anim",!0)}else this.keys.up.isDown&&this.body.blocked.down?this.jump():this.isJumping?1===this.direction?this.bigMode?this.anims.play("bigJumpRight_anim",!0):this.anims.play("jumpRight_anim",!0):this.bigMode?this.anims.play("bigJumpLeft_anim",!0):this.anims.play("jumpLeft_anim",!0):(this.body.velocity.x=0,1===this.direction?this.bigMode?this.anims.play("bigFaceRight_anim",!0):this.anims.play("faceRight_anim",!0):this.bigMode?this.anims.play("bigFaceLeft_anim",!0):this.anims.play("faceLeft_anim",!0));else this.die()}},{key:"jump",value:function(){this.body.velocity.y=-1*this.jumpSpeed}},{key:"changeMode",value:function(e){var t=this,i=[function(){t.life--,t.alive=!1,t.direction=0,t.body.velocity.x=0,t.emitter.stopFollow(t),t.emitter.explode()},function(){t.bigMode=!1,t.ability.fireball=!1,t.ability.invincible=!1,console.log(t.scene),t.setSize(16,16),t.setOffset(0,0)},function(){t.bigMode=!0,t.ability.fireball=!1,t.ability.invincible=!1,t.setSize(16,32),t.setOffset(0,0),t.y-=16,t.emitter.stopFollow(t)},function(){t.bigMode=!0,t.ability.fireball=!0,t.emitter.startFollow(t)}];"upgrade"===e?this.currentModeIndex=this.currentModeIndex<i.length-1?++this.currentModeIndex:this.currentModeIndex:"downgrade"===e?this.currentModeIndex=this.currentModeIndex>0?--this.currentModeIndex:0:"die"===e&&(this.currentModeIndex=0),i[this.currentModeIndex]()}},{key:"small",value:function(){this.body.setSize(10,10)}},{key:"large",value:function(){this.body.setSize(10,22),this.body.offset.set(3,10)}},{key:"creatAnims",value:function(){this.scene.anims.create({key:"bigRight_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:2,end:4}),frameRate:8,repeat:-1}),this.scene.anims.create({key:"bigLeft_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:8,end:10}),frameRate:8,repeat:-1}),this.scene.anims.create({key:"bigFaceRight_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:1,end:1}),frameRate:1,repeat:1}),this.scene.anims.create({key:"bigFaceLeft_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:11,end:11}),frameRate:1,repeat:1}),this.scene.anims.create({key:"bigJumpRight_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:5,end:5}),frameRate:1,repeat:1}),this.scene.anims.create({key:"bigJumpLeft_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:7,end:7}),frameRate:1,repeat:1}),this.scene.anims.create({key:"bigSquat_anim",frames:this.scene.anims.generateFrameNumbers("big_mario",{start:6,end:6}),frameRate:1,repeat:1})}},{key:"creatControls",value:function(){var e=this;this.keys={left:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),down:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),right:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),up:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),fire:this.scene.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE)},this.scene.input.on("pointerdown",this.handleFire,this),this.scene.input.keyboard.on("keydown",function(t){"Space"===t.code&&e.handleFire()})}},{key:"handleFire",value:function(){if(this.ability.fireball){var e=new w({scene:this.scene,x:this.x,y:this.y});this.scene.playerAttackGroup.add(e),e.fire(this.x,this.y,1!==this.direction)}}},{key:"collidingWithbricksCoinGroup",value:function(e,t){!0!==t.isCollided&&(e.body.touching.up&&t.body.touching.down&&(t.isCollided=!0,this.scene.tweens.add({targets:t,y:t.y-8,callbackScope:this,duration:100,ease:"Quintic",yoyo:!0,onComplete:function(e){t.anims.play("blockCollisioned_anim")}}),new x({scene:this.scene,x:t.x+8,y:t.y+8-16}).collidingBricksCoin()))}},{key:"collidingWithbricksGroup",value:function(e,t){e.body.touching.up&&t.body.touching.down&&(this.bigMode?t.destroy():this.scene.tweens.add({targets:t,y:t.y-8,callbackScope:this,duration:100,ease:"Quintic",yoyo:!0,onComplete:function(e){}}))}},{key:"collidingWithbricksFlowerOrMushroomGroup",value:function(e,t){var i;!0!==t.isCollided&&(e.body.touching.up&&t.body.touching.down&&(t.isCollided=!0,this.scene.tweens.add({targets:t,y:t.y-8,callbackScope:this,duration:100,ease:"Quintic",yoyo:!0,onComplete:function(e){t.anims.play("blockCollisioned_anim")}}),i=this.currentModeIndex>=2?new S({scene:this.scene,x:t.x+8,y:t.y+8-16}):new _({scene:this.scene,x:t.x+8,y:t.y+8-16}),this.scene.mushroomOrFlowerGroup.add(i),i.collidingBricks()))}},{key:"die",value:function(){var e=this;if(!this.dieAnimPlaying){this.dieAnimPlaying=!0,this.anims.play("die_anim"),this.scene.cameras.main.stopFollow();var t=this.scene.tweens.createTimeline();t.add({targets:this,y:this.y-16,ease:"Power1",duration:600}),t.add({targets:this,y:this.y+600,ease:"Power1",duration:2e3,onComplete:function(t){e.life>0?e.scene.restartGame():e.scene.scene.start("gameOverScene",{result:"lose",score:e.scene.score})}}),t.play()}}},{key:"getDamageHandler",value:function(e){this.alive&&("deadZone"===e.type?this.changeMode("die"):"enemy"===e.type&&(this.ability.invincible||this.ability.immune||(this.changeMode("downgrade"),this.setImmune(1e3))))}},{key:"setImmune",value:function(e){var t=this;this.ability.immune=!0,setTimeout(function(){t.ability.immune=!1},e)}}]),t}(Phaser.Physics.Arcade.Sprite),F=function(e){function t(e,i,r,s){var n;return a()(this,t),n=c()(this,l()(t).call(this,e,i,r,s)),e.physics.world.enable(k()(k()(n))),n.scene=e,n.scene.add.existing(k()(k()(n))),n.scene.physics.world.enable(k()(k()(n))),n.direction=-1,n.speed=30,n.life=1,n.alive=!0,n.scene.physics.add.collider(k()(k()(n)),n.scene.graphicLayer,function(){}),n.type="enemy",n}return u()(t,e),n()(t,[{key:"update",value:function(){if(!(Math.abs(this.x-this.scene.player.x)>=450)&&this.alive){if(this.life<=0)return this.alive=!1,this.dieSetting(),!1;this.body.onWall()&&(this.direction*=-1),this.body.velocity.x=this.direction*this.speed}}},{key:"dieSetting",value:function(){var e=this;this.life=0,this.alive=!1,this.direction=0,this.body.velocity.x=0,setTimeout(function(){e.scene.enemiesGroup.remove(e,!0,!0)},2e3)}},{key:"collidingWithFireball",value:function(){if(this.alive){this.scene.score+=10,this.angle=-180;var e=this.scene.tweens.createTimeline();e.add({targets:this,y:this.y-16,ease:"Power1",duration:600}),e.add({targets:this,y:this.y+600,ease:"Power1",duration:3e3}),e.play(),this.dieSetting()}}},{key:"fallInDeadZone",value:function(){this.alive&&this.dieSetting()}}]),t}(Phaser.Physics.Arcade.Sprite),L=function(e){function t(e,i,r,s){var n;return a()(this,t),(n=c()(this,l()(t).call(this,e,i,r,s))).anims.play("goombaWalk_anim"),n}return u()(t,e),n()(t,[{key:"collidingWithPlayer",value:function(){this.body.touching.up&&this.scene.player.body.touching.down?(this.dieSetting(),this.scene.score+=20,this.anims.play("goombaDie_anim")):this.alive&&this.scene.player.eventEmitter.emit("getDamage",this)}}]),t}(F),O=function(e){function t(e,i,r,s){var n;return a()(this,t),(n=c()(this,l()(t).call(this,e,i,r,s))).walk(),n.isSquished=!1,n.onRecover=!1,n.isSquishFly=!1,n.recoveryInterval=3e3,n.timeManage={nowTime:0,startSquish:0,startRecover:0,recoverFinish:0},n}return u()(t,e),n()(t,[{key:"update",value:function(e,t){if(!(Math.abs(this.x-this.scene.player.x)>=450)&&(this.timeManage.nowTime=e,this.alive)){if(this.life<=0)return this.alive=!1,this.dieSetting(),!1;if(this.isSquished){if(this.isSquishFly?(this.speed=300,this.scene.physics.world.collide(this,this.scene.enemiesGroup,function(e,t){t.collidingWithFireball()})):this.speed=30,this.timeManage.startRecover<this.timeManage.nowTime&&this.timeManage.recoverFinish>this.timeManage.nowTime&&!this.isSquishFly){if(this.onRecover)return;this.anims.play("koopaSquishRecover_anim"),this.onRecover=!0}this.timeManage.recoverFinish<this.timeManage.nowTime&&!this.isSquishFly&&(this.walk(),this.direction=-1,this.onRecover=!1)}this.flipX=14===this.body.facing,(this.body.blocked.right||this.body.blocked.left)&&(this.direction*=-1),this.body.velocity.x=this.speed*this.direction}}},{key:"walk",value:function(){this.anims.play("koopaWalk_anim"),this.isSquished=!1,this.setSize(16,24),this.setOffset(0,0)}},{key:"squish",value:function(){this.anims.play("koopaSquish_anim"),this.isSquished=!0,this.setSize(16,16),this.setOffset(0,0)}},{key:"collidingWithPlayer",value:function(){this.body.touching.up&&this.scene.player.body.touching.down?this.isSquished?(this.scene.player.x-this.x>=this.body.halfWidth?this.direction=-1:this.direction=1,this.squish(),this.isSquishFly=!0):(this.direction=0,this.body.velocity.x=0,this.anims.stop(),this.squish(),this.scene.player.jump(),this.timeManage.startSquish=this.timeManage.nowTime,this.timeManage.startRecover=this.timeManage.nowTime+this.recoveryInterval,this.timeManage.recoverFinish=this.timeManage.startRecover+this.recoveryInterval):(this.alive&&!this.isSquished&&this.scene.player.eventEmitter.emit("getDamage",this),this.isSquishFly&&this.scene.player.eventEmitter.emit("getDamage",this))}}]),t}(F),G=(Phaser.Physics.Arcade.Sprite,i(8)),j=i.n(G),M=(Phaser.GameObjects.Text,function(e){function t(){var e;return a()(this,t),(e=c()(this,l()(t).call(this,{key:"GameScene"}))).cameraMode="follow",e.level={width:3840,height:624},e}return u()(t,e),n()(t,[{key:"init",value:function(e){"{}"===JSON.stringify(e)?this.gameConfig={scene:{score:0},player:{life:3}}:this.gameConfig=e}},{key:"create",value:function(){var e=this;if(this.score=this.gameConfig.scene.score,this.initRegister(),this.createAnims(),this.createLayer(),this.physics.world.bounds.width=this.graphicLayer.width,this.physics.world.bounds.height=this.graphicLayer.height,this.showDebug=!0,this.debugGraphics=this.add.graphics(),this.drawDebug(),this.input.keyboard.on("keydown_U",function(t){e.showDebug=!e.showDebug,e.drawDebug(),e.player.changeMode("downgrade")}),this.input.keyboard.on("keydown_I",function(t){e.player.changeMode("upgrade")}),this.player=new P({scene:this,x:260,y:110},this.gameConfig.player),"follow"===this.cameraMode)this.cameras.main.setSize(700,224),this.cameras.main.setBounds(0,0,this.level.width,this.level.height),this.cameras.main.startFollow(this.player,!0,1,1,0,100);else{this.cameras.main.setScroll(300,0);var t=this.input.keyboard.createCursorKeys(),i=(this.cameras.main,t.left,t.right,t.up,t.down,this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Q),this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E),{camera:this.cameras.main,left:t.left,right:t.right,up:t.up,down:t.down,speed:.5});this.controls=new Phaser.Cameras.Controls.FixedKeyControl(i)}this.cameras.main.setBackgroundColor(6850815),this.scoreText=this.add.text(0,0,"score : 0").setScrollFactor(0),this.debugText={pointPosition:this.add.text(0,50,"指针:").setScrollFactor(0),playerLife:this.add.text(120,0,"生命:").setScrollFactor(0)},this.events.on("drawDebugEvent",function(){log("this.events.on('drawDebugEvent') 参数: "+arguments[0])},this),this.crosshair=this.add.sprite(0,0,"crosshair").setAlpha(0),this.input.on("pointermove",function(t){e.crosshair.setPosition(t.x+e.cameras.main.scrollX,t.y+e.cameras.main.scrollY)}),this.createGroupFromObjects(),this.createCollision()}},{key:"update",value:function(e,t){"keyControl"===this.cameraMode&&this.controls.update(t),this.player.update(e,t),this.updateText()}},{key:"createLayer",value:function(){this.map=this.add.tilemap("level1");var e=this.map.addTilesetImage("tileset_levels");this.graphicLayer=this.map.createDynamicLayer("Graphic_Layer",e,0,0),this.pipesAccessLevelLayer=this.map.createDynamicLayer("PipesAccessLevel",e,0,0),this.pipesAccessLayer=this.map.createDynamicLayer("PipesAccess",e,0,0),this.exitPipesLayer=this.map.createDynamicLayer("ExitPipes",e,0,0),this.finishLevelLayer=this.map.createDynamicLayer("FinishLevel",e,0,0)}},{key:"drawDebug",value:function(){var e=this;this.debugGraphics.clear(),this.showDebug&&setTimeout(function(){e.graphicLayer.renderDebug(e.debugGraphics,{tileColor:null,collidingTileColor:new Phaser.Display.Color(254,209,16,100)})},1),this.events.emit("drawDebugEvent",1,2)}},{key:"updateText",value:function(){this.scoreText.setText("score :"+this.score),this.debugText.pointPosition.setText("指针:"+~~this.crosshair.x+","+~~this.crosshair.y),this.debugText.playerLife.setText("生命:"+this.player.life)}},{key:"createAnims",value:function(){this.anims.create({key:"randomBox_anim",frames:this.anims.generateFrameNumbers("randomBox",{start:0,end:2}),frameRate:1,repeat:-1}),this.anims.create({key:"brick_anim",frames:this.anims.generateFrameNumbers("brick",{start:0,end:0}),frameRate:1,repeat:1}),this.anims.create({key:"blockCollisioned_anim",frames:this.anims.generateFrameNumbers("blockCollisioned",{start:0,end:0}),frameRate:1,repeat:1}),this.anims.create({key:"goombaWalk_anim",frames:this.anims.generateFrameNumbers("goomba_red",{start:0,end:1}),frameRate:4,repeat:-1}),this.anims.create({key:"goombaDie_anim",frames:this.anims.generateFrameNumbers("goomba_red",{start:2,end:2}),frameRate:1,repeat:1}),this.anims.create({key:"koopaWalk_anim",frames:this.anims.generateFrameNumbers("koopa_green",{start:0,end:1}),frameRate:4,repeat:-1}),this.anims.create({key:"koopaSquish_anim",frames:[{frame:"Enemies/Koopa/koopa green squish 2",key:"atlas_object"}]}),this.anims.create({key:"koopaSquishRecover_anim",frames:this.anims.generateFrameNumbers("koopa_green_squish",{start:0,end:1}),frameRate:6,repeat:6}),this.anims.create({key:"coinBlock_anim",frames:this.anims.generateFrameNumbers("coinBlock",{start:0,end:3}),frameRate:4,repeat:-1}),this.anims.create({key:"mushroom_anim",frames:this.anims.generateFrameNumbers("mushroom",{start:0,end:0}),frameRate:1,repeat:1}),this.anims.create({key:"flower_anim",frames:this.anims.generateFrameNumbers("flower",{start:0,end:3}),frameRate:4,repeat:-1})}},{key:"createGroupFromObjects",value:function(){var e=this;this.playerAttackGroup=this.add.group(),this.playerAttackGroup.runChildUpdate=!0,this.enemiesGroup=this.add.group(),this.enemiesGroup.runChildUpdate=!0,this.coinsGroup=this.add.group(),this.coinsGroup.runChildUpdate=!0,this.mushroomOrFlowerGroup=this.add.group(),this.mushroomOrFlowerGroup.runChildUpdate=!0,this.flowerGroup=this.add.group(),this.flowerGroup.runChildUpdate=!0;var t=this.map.createFromObjects("Bricks","bricks",{key:"bricks"});this.bricksGroup=this.physics.add.staticGroup(),this.bricksGroup.runChildUpdate=!0,this.objectsAddToGroup(t,"brick_anim",this.bricksGroup),this.map.getObjectLayer("Goombas").objects.forEach(function(t){var i=new L(e,t.x+8,t.y+8,"goomba_red");e.enemiesGroup.add(i)}),this.map.getObjectLayer("Koopas").objects.forEach(function(t){var i=new O(e,t.x+8,t.y+8,"koopa_green");i.body.height=t.height,e.enemiesGroup.add(i)});var i=this.map.createFromObjects("DeadZones","deadZones",{key:"deadZones"});this.deadZoneGroup=this.physics.add.staticGroup(),i.forEach(function(t,i){t.setOrigin(0),t.width=t.width*t._scaleX,t.height=t.height*t._scaleY,t.x=t.x-t.width/2,t.y=t.y+t.height/2,t.setScale(1),t.alpha=0,t.type="deadZone",e.deadZoneGroup.add(t)}),this.bricksCoinGroup=this.physics.add.staticGroup();var r=this.map.createFromObjects("BricksCoin","bricksCoin",{key:"bricksCoin"});this.objectsAddToGroup(r,"randomBox_anim",this.bricksCoinGroup),this.map.getObjectLayer("Coins").objects.forEach(function(t){var i=new x({scene:e,x:t.x+8,y:t.y+8});e.coinsGroup.add(i)}),this.bricksFlowerOrMushroomGroup=this.physics.add.staticGroup();var a=this.map.createFromObjects("BricksFlowerOrMushroom","bricksFlowerOrMushroom",{key:"bricksFlowerOrMushroom"});this.objectsAddToGroup(a,"randomBox_anim",this.bricksFlowerOrMushroomGroup)}},{key:"objectsAddToGroup",value:function(e,t,i){var r=this;e.forEach(function(e,a){e.setOrigin(0),e.width=e.width*e._scaleX,e.height=e.height*e._scaleY,e.x=e.x-e.width/2,e.y=e.y+e.height/2,e.setScale(1),e.isCollided=!1,r.anims.play(t,e),i.add(e)})}},{key:"createCollision",value:function(){var e=this;this.graphicLayer.setCollision([1,34,67,69,265,266,267,268,269,298,299,300,301,301,302]),this.pipesAccessLayer.setCollision([265,266]),this.exitPipesLayer.setCollision([267,300]),this.finishLevelLayer.setCollision([281,314]),this.physics.add.collider(this.player,this.graphicLayer),this.physics.add.collider(this.player,this.pipesAccessLayer,function(t,i){t.body.blocked.down&&e.player.keys.down.isDown&&("follow"===e.cameraMode&&e.cameras.main.startFollow(e.player,!0,1,1,0,-100),e.player.setPosition(935,425))}),this.physics.add.collider(this.player,this.exitPipesLayer,function(t,i){t.body.blocked.right&&e.player.keys.right.isDown&&("follow"===e.cameraMode&&e.cameras.main.startFollow(e.player,!0,1,1,0,100),e.player.setPosition(2640,143))}),this.physics.add.collider(this.player,this.finishLevelLayer,function(t,i){(t.body.blocked.right||t.body.blocked.left)&&e.end("win")}),this.physics.add.collider(this.player,this.coinsGroup,function(e,t){t.collidingWithPlayer()}),this.physics.add.collider(this.player,this.bricksCoinGroup,function(e,t){e.collidingWithbricksCoinGroup(e,t)}),this.physics.add.collider(this.player,this.bricksFlowerOrMushroomGroup,function(e,t){e.collidingWithbricksFlowerOrMushroomGroup(e,t)}),this.physics.add.collider(this.player,this.bricksGroup,function(e,t){e.collidingWithbricksGroup(e,t)}),this.physics.add.collider(this.playerAttackGroup,this.graphicLayer,function(e,t){e.collided()}),this.physics.add.collider(this.playerAttackGroup,this.enemiesGroup,function(e,t){e.explode(),t.collidingWithFireball()}),this.physics.add.overlap(this.player,this.enemiesGroup,function(e,t){t.collidingWithPlayer()}),this.physics.add.collider(this.player,this.deadZoneGroup,function(e,t){e.eventEmitter.emit("getDamage",t)}),this.physics.add.overlap(this.enemiesGroup,this.deadZoneGroup,function(e,t){e.fallInDeadZone()}),this.physics.add.collider(this.enemiesGroup,this.bricksGroup,function(){}),this.physics.add.collider(this.mushroomOrFlowerGroup,this.bricksGroup,function(){}),this.physics.add.overlap(this.player,this.mushroomOrFlowerGroup,function(e,t){t.collidingWithPlayer(e,t)})}},{key:"end",value:function(e){var t=this;"restart"===e?this.scene.restart():"lose"===e?(this.cameras.main.fade(1e3,16.5,2,1.2),this.events.emit("gameOver"),this.time.addEvent({delay:1e3,callbackScope:this,callback:function(){t.scene.start("gameOverScene","lose")}})):"win"===e&&(this.cameras.main.fade(1e3,16.5,2,1.2),this.events.emit("gameOver"),this.time.addEvent({delay:1e3,callbackScope:this,callback:function(){t.scene.start("gameOverScene","win")}}))}},{key:"initRegister",value:function(){this.registry.set("coins_max","coins_max")}},{key:"restartGame",value:function(){var e={scene:{score:this.score},player:{life:this.player.life}};this.scene.start("GameScene",e)}}]),t}(Phaser.Scene)),C=function(e){function t(){return a()(this,t),c()(this,l()(t).call(this,{key:"GameOverScene"}))}return u()(t,e),n()(t,[{key:"init",value:function(e){this.condition=e}},{key:"create",value:function(){var e,t={fill:"#ffffff",align:"center",fontSize:36,fontStyle:"bold",padding:0};this.cameras.main.setBackgroundColor(2753795),"win"===this.condition.result?(e="Victory",this.overText=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2-64,"atlas","win")):"lose"===this.condition.result&&(e="Defeat",this.overText=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2-64,"atlas","gameOver")),this.input.keyboard.on("keydown_ENTER",function(e){location.reload()}),this.cameras.main.stopFollow(),this.cameras.main.setScroll(0,0),this.add.text(100,100,e,t),this.add.text(100,200,"回车重玩",t)}}]),t}(Phaser.Scene),R=function(e){function t(){return a()(this,t),c()(this,l()(t).call(this,{key:"BlankScene"}))}return u()(t,e),n()(t,[{key:"create",value:function(){var e=this;this.title=this.add.sprite(this.sys.game.config.width/2,80,"atlas_object","UI/Menu/title"),this.pressX=this.add.bitmapText(this.sys.game.config.width/2,144,"font","PRESS X TO START",8).setOrigin(.5,.5),setInterval(function(){e.pressX.alpha=1===e.pressX.alpha?0:1},500)}},{key:"update",value:function(e,t){}}]),t}(Phaser.Scene),E={type:Phaser.AUTO,pixelArt:!0,roundPixels:!0,parent:"phaser-example",title:"Phaser3 Mario",width:700,height:224,fps:60,physics:{default:"arcade",arcade:{gravity:{y:300},debug:!0}},scene:[b,M,C,R]};console.log("当前处于 %c".concat("production","%c 模式"),"background:#fff;color: #f00","");new Phaser.Game(E)}]);